var mapPage={initialize:function(){mapPage.attachEvents()},attachEvents:function(){$("#processing-modal").modal("show");$.ajax({type:"GET",url:"/Map/PlotMarker",contentType:"application/json; charset=utf-8",dataType:"json",async:!0,cache:!1,success:function(n){var t,i,r,u;t=n;t[0]==undefined?(i=56.1304,r=106.3468,$("#alert").modal("show"),$("#alertHeader").text("Asset Location"),$("#alertBody").text("No location information available for this asset. The map will only show your current location")):(i=t[0].latitude,r=t[0].longitude);navigator.geolocation?(u="https://www.robotwoods.com/dev/misc/bluecircle.png",navigator.geolocation.getCurrentPosition(function(n){var f,i,h,l,a;f=new google.maps.LatLng(n.coords.latitude,n.coords.longitude);var c={center:f,zoom:14,minZoom:2,mapTypeId:google.maps.MapTypeId.ROADMAP},r=new google.maps.Map(document.getElementById("map"),c),e=new google.maps.Marker({position:f,map:r,icon:{path:google.maps.SymbolPath.CIRCLE,fillOpacity:.5,fillColor:"#cf7f00",strokeOpacity:1,strokeColor:"#1a355e",strokeWeight:20,radius:800,scale:20},title:"Your location:<\/b><br />Latitude: "+n.coords.latitude+"<br />Longitude: "+n.coords.longitude}),u=new google.maps.InfoWindow({maxWidth:500}),s=new google.maps.LatLngBounds,o=[],o=[];for(o.push(e),i=0;i<t.length;i++)h=new google.maps.LatLng(t[i].latitude,t[i].longitude),marker=new google.maps.Marker({position:h}),t[i].latitude!=null&&(t[i].isFavorite==!0?marker.setIcon("/images/favorite-location.png"):marker.setIcon("/images/location.png")),l=t[i],o.push(marker),s.extend(marker.position),google.maps.event.addListener(marker,"click",function(n,i){return function(){u.setContent('<b><a href="#" id="direction"><img src="/images/car-Icon.png" /><\/a> &nbsp; <a href="/WellLineReport/Index?wellId='+Base64.encode(t[i].id.toString())+"&wellName="+Base64.encode(t[i].name.toString())+"&isFollow="+Base64.encode(t[i].isFavorite.toString())+'">'+t[i].name)+"<\/a><\/b>";u.open(r,n);$("#direction").click(function(){mapPage.showDirection(t[i])})}}(marker,i)),google.maps.event.addListener(e,"click",function(n){return function(){u.setContent("<b>Your Current Location<\/b>");u.open(r,n)}}(e));r.fitBounds(s);a=new MarkerClusterer(r,o,{imagePath:"https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/m"})})):alert("Geo Location feature is not supported in this browser.");$("#processing-modal").modal("hide")}})},showDirection:function(n){navigator.geolocation?navigator.geolocation.getCurrentPosition(function(t){var f,u,o;f=new google.maps.LatLng(t.coords.latitude,t.coords.longitude);var s={center:f,zoom:14,minZoom:2,mapTypeId:google.maps.MapTypeId.ROADMAP},i=new google.maps.Map(document.getElementById("map"),s),r=new google.maps.InfoWindow({maxWidth:500}),e;e=n.isFavorite==!0?"/images/favorite-location.png":"/images/location.png";u=new google.maps.DirectionsRenderer;o=new google.maps.DirectionsService;u.setMap(i);u.setOptions({suppressMarkers:!0});o.route({origin:{lat:t.coords.latitude,lng:t.coords.longitude},destination:{lat:n.latitude,lng:n.longitude},travelMode:google.maps.TravelMode.DRIVING},function(t,f){var s,o,h;f=="OK"?(u.setDirections(t),s=t.routes[0].legs[0],pinA=new google.maps.Marker({position:s.start_location,map:i,icon:{path:google.maps.SymbolPath.CIRCLE,fillOpacity:.5,fillColor:"#cf7f00",strokeOpacity:1,strokeColor:"#1a355e",strokeWeight:20,radius:800,scale:20}}),pinB=new google.maps.Marker({position:s.end_location,map:i,icon:e}),google.maps.event.addListener(pinB,"click",function(t){return function(){r.setContent('<b><a href="/WellLineReport/Index?wellId='+Base64.encode(n.id.toString())+"&wellName="+Base64.encode(n.name.toString())+"&isFollow="+Base64.encode(n.isFavorite.toString())+'">'+n.name)+"<\/a><\/b>";r.open(i,t)}}(pinB)),google.maps.event.addListener(pinA,"click",function(t){return function(){r.setContent('<b><a href="#" id="navigationStep">Navigation Steps<\/a><\/b> &nbsp;');r.open(i,t);$("#navigationStep").click(function(){mapPage.navigateStep(n)})}}(pinA)),o=[],o.push(pinA),o.push(pinB),h=new MarkerClusterer(i,o,{imagePath:"https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/m"})):window.alert("Directions request failed due to "+f)})}):alert("Geo Location feature is not supported in this browser.")},navigateStep:function(n){$("#map").addClass("col-lg-8");$("#panel").addClass("col-lg-4 scrolable-div");$("#drivingDirection").removeClass("hide-div");$("#drivingDirection").addClass("show-div mr-100");$("#headingMap").addClass("ml-15");navigator.geolocation?navigator.geolocation.getCurrentPosition(function(t){var f,e,r,o;f=new google.maps.LatLng(t.coords.latitude,t.coords.longitude);currentUserLatLong=f;var s={center:f,zoom:14,minZoom:2,mapTypeId:google.maps.MapTypeId.ROADMAP},i=new google.maps.Map(document.getElementById("map"),s),u=new google.maps.InfoWindow({maxWidth:500});e=n.isFavorite==!0?"/images/favorite-location.png":"/images/location.png";r=new google.maps.DirectionsRenderer;o=new google.maps.DirectionsService;r.setMap(i);r.setPanel(document.getElementById("panel"));r.setOptions({suppressMarkers:!0});o.route({origin:{lat:t.coords.latitude,lng:t.coords.longitude},destination:{lat:n.latitude,lng:n.longitude},travelMode:google.maps.TravelMode.DRIVING},function(t,f){var s,o,h;f=="OK"?(r.setDirections(t),s=t.routes[0].legs[0],pinA=new google.maps.Marker({position:s.start_location,map:i,icon:{path:google.maps.SymbolPath.CIRCLE,fillOpacity:.5,fillColor:"#cf7f00",strokeOpacity:1,strokeColor:"#1a355e",strokeWeight:20,radius:800,scale:20}}),pinB=new google.maps.Marker({position:s.end_location,map:i,icon:e}),google.maps.event.addListener(pinA,"click",function(n){return function(){u.setContent("<b><\/b>");u.open(i,n)}}(pinA)),google.maps.event.addListener(pinB,"click",function(t){return function(){u.setContent('<b><a href="/WellLineReport/Index?wellId='+Base64.encode(n.id.toString())+"&wellName="+Base64.encode(n.name.toString())+"&isFollow="+Base64.encode(n.isFavorite.toString())+'">'+n.name.toString())+"<\/a><\/b>";u.open(i,t)}}(pinB)),o=[],o.push(pinA),o.push(pinB),h=new MarkerClusterer(i,o,{imagePath:"https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/m"})):window.alert("Directions request failed due to "+f)})}):alert("Geo Location feature is not supported in this browser.")}};