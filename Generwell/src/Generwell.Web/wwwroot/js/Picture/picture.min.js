var picturePage={initialize:function(){picturePage.attachEvents()},attachEvents:function(){picturePage.addPicture();picturePage.createCheckbox();picturePage.swapRadioButton();picturePage.editPictureLabel();picturePage.deletePicture();picturePage.redirectToIndexPage();picturePage.uploadPicture();picturePage.validateImage()},redirectToIndexPage:function(){$("#cancel").click(function(){$("#processing-modal").modal("show");picturePage.redirectToPreviousPage()})},addPicture:function(){$("#addPicture").click(function(){var n,t;n=$("#albumId").val();$("#processing-modal").modal("show");t="/Picture/AddPicture?albumId="+Base64.encode(n);window.location.href=t})},editPicture:function(n,t,i,r,u){$("#processing-modal").modal("show");var f="/Picture/EditPicture?fileUrl="+Base64.encode(n)+"&label="+Base64.encode(t!=null?t:"")+"&comment="+Base64.encode(i!=null?i:"")+"&id="+Base64.encode(r)+"&albumId="+Base64.encode(u);window.location.href=f},createCheckbox:function(){$(".i-checks").iCheck({checkboxClass:"icheckbox_square-green",radioClass:"iradio_square-green"})},swapRadioButton:function(){$(".iCheck-helper").click(function(){$(this).parent().children().attr("id")=="edit"?($("#delete").parent().removeClass("checked"),$("#edit").parent().addClass("checked"),$("#editPicture").removeAttr("disabled"),$("#editPicture").addClass("button"),$("#deletePicture").removeClass("button"),$("#deletePicture").attr("disabled","disabled"),picturePage.editPictureLabel()):($("#savePicture").unbind("click"),$("#savePicture").attr("value","Edit"),$("#savePicture").attr("id","editPicture"),$("#edit").parent().removeClass("checked"),$("#delete").parent().addClass("checked"),$("#editPicture").attr("disabled","disabled"),$("#deletePicture").addClass("button"),$("#editPicture").removeClass("button"),$("#deletePicture").removeAttr("disabled",""),$("#label").attr("disabled","disabled"),$("#comment").attr("disabled","disabled"))})},editPictureLabel:function(){$("#editPicture").bind("click",function(){$("#label").removeAttr("disabled");$("#comment").removeAttr("disabled");$("#editPicture").attr("value","Save");$("#editPicture").attr("id","savePicture");$("#savePicture").unbind().click(function(){picturePage.updatePicture()})})},deletePicture:function(){$("#deletePicture").click(function(){swal({title:"Delet Picture",text:"Are you sure?",type:"warning",showCancelButton:!0,confirmButtonColor:"#cf7f00",confirmButtonText:"Yes, delete it!",closeOnConfirm:!1},function(){$("#processing-modal").modal("show");picturePage.deletePictureCall();swal("deleted!","Picture deleted successfully","success");picturePage.redirectToPreviousPage()})})},deletePictureCall:function(){var n=$("#pictureId").val();$.ajax({type:"GET",url:"/Picture/DeletePicture",data:{pictureId:n},datatype:"json",cache:!1,success:function(){},error:function(){$("#processing-modal").modal("hide")}})},updatePicture:function(){var n=picturePage.getViewData(),t=$("#pictureId").val();$("#processing-modal").modal("show");$.ajax({type:"GET",url:"/Picture/UpdatePicture",data:{Content:JSON.stringify(n),pictureId:t},datatype:"json",cache:!1,success:function(){picturePage.redirectToPreviousPage()},error:function(){$("#processing-modal").modal("hide")}})},redirectToPreviousPage:function(){var n=$("#albumId").val(),t="/Picture/Index/"+Base64.encode(n);window.location.href=t},getViewData:function(){$("#processing-modal").modal("show");var t=[],i=[],r=[],n=0;return $(".clsedit").each(function(){var u=$(this).prop("type");u=="text"?(t.push(this.name),i.push(this.value),r.push('{ "op": "replace", "path": "/'+t[n]+'", "value": "'+i[n].trim()+'"}')):u=="textarea"&&(t.push(this.name),i.push(this.value),r.push('{ "op": "replace", "path": "/'+t[n]+'", "value": "'+i[n].trim()+'"}'));n++}),r},uploadPicture:function(){$("#fileupload").change(function(){var t,n;$("#dvPreview").html("");t=/^([a-zA-Z0-9\s_\\.\-:])+(.jpg|.jpeg|.gif|.png|.bmp)$/;t.test($(this).val().toLowerCase())?$.browser!=undefined&&$.browser.msie&&parseFloat(jQuery.browser.version)<=9?($("#dvPreview").show(),$("#dvPreview")[0].filters.item("DXImageTransform.Microsoft.AlphaImageLoader").src=$(this).val()):typeof FileReader!="undefined"?($("#dvPreview").show(),$("#dvPreview").append("<img />"),n=new FileReader,n.onload=function(n){$("#dvPreview img").attr("src",n.target.result)},n.readAsDataURL($(this)[0].files[0]),$("#dvPreview img").addClass("img-responsive wh-300")):alert("This browser does not support FileReader."):alert("Please upload a valid image file.")})},validateImage:function(){$("form[name=pictureForm]").submit(function(){$("#processing-modal").modal("show");var n=$("#dvPreview img").attr("src"),t=$.trim($("#label").val()),i=$.trim($("#comment").val());return n==undefined?($("#imageError").text("<b>Picture is required.<\/b>"),$("#labelError").text(""),$("#commentError").text(""),$("#processing-modal").modal("hide"),!1):t==""?($("#labelError").text("Label name is required."),$("#imageError").text(""),$("#commentError").text(""),$("#processing-modal").modal("hide"),!1):i==""?($("#commentError").text("Comment is required."),$("#imageError").text(""),$("#labelError").text(""),$("#processing-modal").modal("hide"),!1):void 0})}};