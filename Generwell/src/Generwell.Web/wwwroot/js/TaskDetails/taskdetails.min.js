var TaskDetailsPage={initialize:function(n){TaskDetailsPage.attachEvents(n)},attachEvents:function(){TaskDetailsPage.completeEvent();TaskDetailsPage.createMyFilterCheckbox();TaskDetailsPage.changeButtonEvent();TaskDetailsPage.bindEvent();TaskDetailsPage.createDatetime()},createDatetime:function(){$(".datepicker").datepicker({format:"M dd,yyyy",autoclose:!0,todayBtn:!0});$(".datetimepicker").datetimepicker({format:"MMM DD,YYYY HH:MM A"})},completeTask:function(){var n=[];return n.push('{ "op": "replace", "path": "/Completed", "value": true}'),$("#processing-modal").modal("hide"),TaskDetailsPage.callCompleteTask(n)},callUpdateTask:function(n){var t=!1;return $("#processing-modal").modal("show"),$.ajax({type:"GET",url:"/taskdetails/updatetaskfields",data:{Content:JSON.stringify(n)},datatype:"json",cache:!1,async:!0,success:function(n){var i,r,u;n==""&&(TaskDetailsPage.showSweetAlert("Task saved successfully."),t=!0);i=TaskDetailsPage.checkJsonFormat(n);i&&(t=!0,r=jQuery.parseJSON(n),u=TaskDetailsPage.createTable(r),TaskDetailsPage.displayValidationMsg(u));$("#processing-modal").modal("hide");$("#completeTask").css("display","block");$("#ReSaveTaskFieldDetailsId").css("display","none");TaskDetailsPage.changeButtonEvent()},error:function(){$("#processing-modal").modal("hide")}}),t},displayValidationMsg:function(n){swal({title:"<h4>Validation Rule Errors<\/h4>",text:n,html:!0,type:"error",confirmButtonColor:"#cf7f00",confirmButtonText:"Ok",closeOnConfirm:!0},function(){TaskDetailsPage.closeSweetAlert();$("#processing-modal").modal("show");location.reload()})},closeSweetAlert:function(){swal({title:"",type:"error",confirmButtonColor:"#cf7f00",confirmButtonText:"Ok",timer:1})},callCompleteTask:function(n){var t=!1;return TaskDetailsPage.closeSweetAlert(),$("#processing-modal").modal("show"),$.ajax({type:"GET",url:"/taskdetails/updatetaskfields",data:{Content:JSON.stringify(n)},datatype:"json",cache:!1,async:!0,success:function(n){$("#processing-modal").modal("hide");n==""?(t=!0,TaskDetailsPage.showSweetAlert("Task completed successfully."),$("#completeTask").css("display","none"),$("#savedDetails").css("display","block")):TaskDetailsPage.showDangerAlert()},error:function(){$("#processing-modal").modal("hide")}}),t},showDangerAlert:function(){$("#newCmpMessage").html("<button aria-hidden='true' data-dismiss='alert' class='close' type='button'>×<\/button>Task not marked as complete. Completion criteria not met.");$("#newCmpMessage").addClass("alert-danger");$("#newCmpMessage").show();setTimeout(function(){$("#newCmpMessage").hide()},3e3)},checkJsonFormat:function(n){try{JSON.parse(n)}catch(t){return!1}return!0},completeEvent:function(){$("#completeTask").click(function(){swal({title:"Task Complete",text:"YES/NO complete Re-activated task?",type:"warning",showCancelButton:!0,confirmButtonColor:"#cf7f00",confirmButtonText:"Yes, complete it!",closeOnConfirm:!1},function(){var n=TaskDetailsPage.completeTask()})})},showSweetAlert:function(n){$("#newCmpMessage").html("<button aria-hidden='true' data-dismiss='alert' class='close' type='button'>×<\/button>"+n);$("#newCmpMessage").addClass("alert-success");$("#newCmpMessage").removeClass("alert-danger");$("#newCmpMessage").show();setTimeout(function(){$("#newCmpMessage").hide()},3e3)},createTable:function(n){var t='<div class="row">';for(t+='<div class="col-md-12 col-lg-12 col-sm-12 col-xs-12 v-scroll">',i=0;i<n.length;i++)t+='<div id="validation" class="form-group border-bottom text-left ibox-content col-md-12 col-lg-12 col-sm-12 col-xs-12">',t+='<label class="text-red">'+n[i].fieldDesc+"<\/label>",t+='<br /><label class="validationLable">Old Value: <\/label>',t+=n[i].oldValue,t+='<br /><label class="validationLable">New Value: <\/label>',t+=n[i].newValue,t+='<br /><label class="validationLable">Instructions: <\/label>',t+=n[i].instructions,t+="<\/div>";return t+"<\/div>"},getViewData:function(){var n=[],i=[],r=[],t=0;return $(".clsedit").each(function(){var u=$(this).prop("type"),e,o,s,h,c,f,l;u=="select-one"?(e=$(this).find(":selected").val(),o=$(this).find(":selected").text(),n.push(this.id),i.push(e),f=this.id,o=$(this).find(":selected").text(),r.push('{ "op": "replace", "path": "/Fields/'+this.id+'", "value": "'+e+'"}')):u=="text"?(n.push(this.id),i.push(this.value),this.name=="date"?(f=this.id,s=this.value,s!=""?r.push('{ "op": "replace", "path": "/Fields/'+n[t]+'", "value":  '+Date.parse(i[t])/1e3+"  }"):r.push('{ "op": "replace", "path": "/Fields/'+n[t]+'", "value":  null  }')):(f=this.id,h=this.value,r.push('{ "op": "replace", "path": "/Fields/'+n[t]+'", "value": "'+i[t]+'"}'))):u=="checkbox"?(c=$("input[name=checkbox]:checked"),n.push(this.id),i.push(this.value),r.push('{ "op": "replace", "path": "/Fields/'+n[t]+'", "value": '+$(this).prop("checked")+"   }")):u=="number"&&(n.push(this.id),i.push(this.value),f=this.id,l=this.value,r.push('{ "op": "replace", "path": "/Fields/'+n[t]+'", "value": "'+i[t]+'"}'));t++}),r},createMyFilterCheckbox:function(){$(".i-checks").iCheck({checkboxClass:"icheckbox_square-green",radioClass:"iradio_square-green"})},changeButtonEvent:function(){var n=$("#reactivatedTask").val();n.toLowerCase()=="re-activated"?($("#completeTask").css("display","block"),$("#savedDetails").css("display","none")):($("#completeTask").css("display","none"),$("#savedDetails").css("display","block"));$(".iCheck-helper").on("click",function(){$("#completeTask").css("display","none");$("#savedDetails").css("display","block")})},getPictureAlbum:function(n,t){var i,t,r;i=Base64.encode(n!=null?n.toString():"");t=Base64.encode(t!=undefined?t.toString():"");$("#processing-modal").modal("show");r="/Picture/Index?id="+i+"&fieldId="+t;window.location.href=r},limitText:function(n,t){return $("#completeTask").css("display","none"),$("#savedDetails").css("display","block"),n.value.length>t?(n.value=n.value.substring(0,t),!1):void 0},checkPeriod:function(n,t,i){if(t!=""){var r=i.name;if(r=="0"&&n.keyCode==46)return n.target.value=t,!1}},check:function(n,t,i){var r,u,f,e;if(t!=""){if(r=i.name,parseFloat(t)>i.max)return t.indexOf(".")>-1?(u=t.substring(0,parseInt(t).toString().length-1),f=t.substring(t.indexOf(".")),n.target.value=u+""+f,!1):(n.target.value=t.substring(0,parseInt(t).toString().length-1),!1);if(t.indexOf(".")>-1&&(e=t.substring(t.indexOf(".")+1),e.length>r))return n.target.value=t.substring(0,t.indexOf(".")+1+r),!1}},bindEvent:function(){$(".chk").find(".iCheck-helper").click(function(){TaskDetailsPage.setWellFollowUnfollow();$("#savedDetails").unbind().click(function(){var n,t;n=TaskDetailsPage.getViewData();n.length>0&&(t=TaskDetailsPage.callUpdateTask(n))})});$("#taskDetailsListTableId input,select").unbind().on("keyup change",function(){$("#savedDetails").unbind().click(function(){var n,t;n=TaskDetailsPage.getViewData();n.length>0&&(t=TaskDetailsPage.callUpdateTask(n))});TaskDetailsPage.setWellFollowUnfollow();$("#completeTask").css("display","none");$("#savedDetails").css("display","block")})},setWellFollowUnfollow:function(){var n=$("#isFollow").val();n==""&&(n="true",$("#isFollow").attr("value","checked"),$.ajax({type:"GET",dataType:"text",url:"/WellLineReport/Follow",data:{isFollow:n},cache:!1,success:function(){swal("Favorites","The corresponding well will be added to your favorite wells.");$("#taskDetailsListTableId input,select").unbind();$(".chk").find(".iCheck-helper").unbind();$("#processing-modal").modal("hide")},error:function(){$("#processing-modal").modal("hide")}}))}};